{
  "openapi": "3.0.0",
  "info": {
    "title": "HireBot AI API Documentation",
    "version": "1.0.0",
    "description": "API documentation for HireBot AI, a service responsible for generating, storing, and managing AI-powered technical interview quizzes for developer candidates.",
    "contact": { "name": "HireBot AI Team" }
  },
  "servers": [{ "url": "http://localhost:3000", "description": "Development server" }],
  "paths": {
    "/api/health-check": {
      "get": {
        "summary": "Basic API health check",
        "description": "Returns a simple status to confirm the API is running",
        "tags": ["Health"],
        "responses": {
          "200": {
            "description": "API is running",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "success" },
                    "message": { "type": "string", "example": "API is running" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/health-check/database": {
      "get": {
        "summary": "Check database connection status",
        "description": "Returns the current status of the database connection",
        "tags": ["Health"],
        "responses": {
          "200": {
            "description": "Database connection information",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "success" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "isConnected": { "type": "boolean", "example": true },
                        "serverAddress": {
                          "type": "string",
                          "example": "mongodb://localhost:27017"
                        },
                        "dbName": { "type": "string", "example": "hirebot_db" }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "error" },
                    "message": {
                      "type": "string",
                      "example": "Failed to check database connection"
                    },
                    "error": { "type": "string", "example": "Connection error" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/questions/generate": {
      "post": {
        "summary": "Generate multiple-choice questions using Gemini AI",
        "description": "Generates technical interview questions based on provided parameters",
        "tags": ["Questions"],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["topic", "language", "position"],
                "properties": {
                  "topic": {
                    "type": "string",
                    "description": "The topic for which questions should be generated",
                    "example": "Data Structures"
                  },
                  "language": {
                    "type": "string",
                    "description": "The programming language for the questions",
                    "example": "JavaScript"
                  },
                  "position": {
                    "type": "string",
                    "description": "Position level (intern, fresher, junior, middle, senior, expert)",
                    "example": "junior"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Questions generated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "success" },
                    "message": { "type": "string", "example": "Questions generated successfully." },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "question": { "type": "string" },
                          "options": { "type": "array", "items": { "type": "string" } },
                          "correctAnswer": { "type": "integer" },
                          "explanation": { "type": "string" },
                          "difficulty": { "type": "string" },
                          "category": { "type": "string" },
                          "topic": { "type": "string" },
                          "language": { "type": "string" },
                          "position": {
                            "type": "string",
                            "description": "Text representation of the position level",
                            "example": "Junior Developer"
                          },
                          "positionLevel": {
                            "type": "integer",
                            "description": "Numeric position level (1-6)",
                            "example": 3
                          },
                          "difficultyLevel": { "type": "integer" },
                          "createdAt": { "type": "string", "format": "date-time" }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - validation error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "error" },
                    "message": { "type": "string", "example": "Validation failed" },
                    "errors": { "type": "array", "items": { "type": "string" } }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "error" },
                    "message": { "type": "string", "example": "Failed to save questions." }
                  }
                }
              }
            }
          },
          "502": {
            "description": "AI service error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "error" },
                    "message": {
                      "type": "string",
                      "example": "Failed to generate questions from AI."
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/questions/search": {
      "get": {
        "summary": "Search for questions based on various criteria",
        "description": "Search for questions by topic, language, position, with sorting and pagination.\nThis endpoint allows you to filter questions based on multiple criteria and\nreturns paginated results that can be sorted by different fields.\n",
        "tags": ["Questions"],
        "parameters": [
          {
            "in": "query",
            "name": "topic",
            "required": true,
            "schema": { "type": "string" },
            "description": "The topic of the questions to search for (e.g., JavaScript, React, Node.js)",
            "example": "JavaScript"
          },
          {
            "in": "query",
            "name": "language",
            "required": true,
            "schema": { "type": "string" },
            "description": "The programming or spoken language of the questions (e.g., JavaScript, Python, Java)",
            "example": "JavaScript"
          },
          {
            "in": "query",
            "name": "position",
            "required": true,
            "schema": {
              "type": "string",
              "enum": ["intern", "fresher", "junior", "middle", "senior", "expert"]
            },
            "description": "The experience level for the questions",
            "example": "junior"
          },
          {
            "in": "query",
            "name": "sort_by",
            "required": false,
            "schema": {
              "type": "string",
              "enum": ["question", "category", "createdAt"],
              "default": "createdAt"
            },
            "description": "Field to sort the results by",
            "example": "createdAt"
          },
          {
            "in": "query",
            "name": "sort_direction",
            "required": false,
            "schema": { "type": "string", "enum": ["asc", "desc"], "default": "desc" },
            "description": "Direction to sort the results (ascending or descending)",
            "example": "desc"
          },
          {
            "in": "query",
            "name": "page",
            "required": false,
            "schema": { "type": "integer", "minimum": 1, "default": 1 },
            "description": "Page number for pagination (starts at 1)",
            "example": 1
          },
          {
            "in": "query",
            "name": "page_size",
            "required": false,
            "schema": { "type": "integer", "minimum": 1, "maximum": 100, "default": 20 },
            "description": "Number of questions per page (max 100)",
            "example": 20
          },
          {
            "in": "query",
            "name": "mode",
            "required": false,
            "schema": {
              "type": "string",
              "enum": ["compact", "full", "minimalist"],
              "default": "full"
            },
            "description": "Response mode - 'full' includes all fields, 'compact' excludes correctAnswer and explanation, 'minimalist' only includes _id and question",
            "example": "full"
          }
        ],
        "responses": {
          "200": {
            "description": "Questions retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "success",
                      "description": "Status of the request"
                    },
                    "message": {
                      "type": "string",
                      "example": "Questions retrieved successfully.",
                      "description": "Success message"
                    },
                    "data": {
                      "type": "array",
                      "description": "Array of questions matching the search criteria",
                      "items": {
                        "type": "object",
                        "properties": {
                          "_id": {
                            "type": "string",
                            "description": "Unique identifier for the question",
                            "example": "60d21b4667d0d8992e610c85"
                          },
                          "question": {
                            "type": "string",
                            "description": "The question text",
                            "example": "What is a closure in JavaScript?"
                          },
                          "options": {
                            "type": "array",
                            "description": "Array of possible answers",
                            "items": { "type": "string" },
                            "example": [
                              "A function that returns another function",
                              "A variable that cannot be changed",
                              "A function with access to its outer scope",
                              "A method to close a connection"
                            ]
                          },
                          "correctAnswer": {
                            "type": "integer",
                            "description": "Index of the correct answer in the options array (0-based)",
                            "example": 2
                          },
                          "explanation": {
                            "type": "string",
                            "description": "Explanation of the correct answer",
                            "example": "A closure is a function that has access to variables from its outer scope."
                          },
                          "difficulty": {
                            "type": "string",
                            "description": "Difficulty level of the question",
                            "example": "medium"
                          },
                          "category": {
                            "type": "string",
                            "description": "Category of the question",
                            "example": "JavaScript Concepts"
                          },
                          "topic": {
                            "type": "string",
                            "description": "Topic of the question",
                            "example": "JavaScript"
                          },
                          "language": {
                            "type": "string",
                            "description": "Programming language of the question",
                            "example": "JavaScript"
                          },
                          "position": {
                            "type": "string",
                            "description": "Position level the question is targeted for",
                            "example": "Junior"
                          },
                          "positionLevel": {
                            "type": "integer",
                            "description": "Numeric representation of the position level",
                            "example": 3
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time",
                            "description": "Date and time when the question was created",
                            "example": "2023-01-01T00:00:00.000Z"
                          }
                        }
                      }
                    },
                    "pagination": {
                      "type": "object",
                      "description": "Pagination information",
                      "properties": {
                        "total": {
                          "type": "integer",
                          "description": "Total number of questions matching the search criteria",
                          "example": 50
                        },
                        "page": {
                          "type": "integer",
                          "description": "Current page number",
                          "example": 1
                        },
                        "page_size": {
                          "type": "integer",
                          "description": "Number of questions per page",
                          "example": 20
                        },
                        "total_pages": {
                          "type": "integer",
                          "description": "Total number of pages",
                          "example": 3
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Bad request - validation error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "error" },
                    "message": { "type": "string", "example": "Validation failed" },
                    "errors": { "type": "array", "items": { "type": "string" } }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": {
                      "type": "string",
                      "example": "error",
                      "description": "Status of the request"
                    },
                    "message": {
                      "type": "string",
                      "example": "An error occurred while searching for questions.",
                      "description": "Error message"
                    },
                    "error": {
                      "type": "string",
                      "example": "Database connection error",
                      "description": "Detailed error information"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/topics": {
      "get": {
        "summary": "Get all topics",
        "description": "Retrieve a list of all available topics",
        "tags": ["Topics"],
        "responses": {
          "200": {
            "description": "A list of topics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "success" },
                    "data": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "title": { "type": "string", "example": "Biến và kiểu dữ liệu" },
                          "difficulty": { "type": "number", "example": 1 },
                          "popularity": { "type": "string", "example": "low" },
                          "suitable_level": { "type": "string", "example": "intern" },
                          "description": {
                            "type": "string",
                            "example": "Chủ đề liên quan đến biến và kiểu dữ liệu, thường gặp trong phỏng vấn lập trình viên."
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "status": { "type": "string", "example": "error" },
                    "message": { "type": "string", "example": "Failed to retrieve topics." }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {},
  "tags": [
    { "name": "Health", "description": "API health check endpoints" },
    { "name": "Questions", "description": "API endpoints for generating and managing questions" },
    { "name": "Topics", "description": "API endpoints for managing topics" }
  ]
}
